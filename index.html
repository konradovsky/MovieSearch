<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Movie 4 today</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="movie.css" type="text/css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" href="fontello/css/fontello.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="http://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="movie.js"></script>
    <script src="typed.js"></script>
  </head>  <body>
  <!--All content of the page is in the container-->
<div class="container-fluid ">
 <div class="row">
   <div class="col-8">

     <div class="row-3 logo">
        <img src="M.png" height="100px" />
     </div>

     <div class="row-9 nav">

       <nav class="navbar navbar-expand-lg navbar-light ">
         <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo03" aria-controls="navbarTogglerDemo03" aria-expanded="false" aria-label="Toggle navigation">
         <span class="navbar-toggler-icon"></span>
         </button>
         <div class="collapse navbar-collapse" id="navbarTogglerDemo03">
           <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
          <li><a href="#">Home</a></li>
          <li id='top10'><a href="#">Top 10</a></li>
          <li><a href="#">Contact Us</a></li>
        </ul>
      </div>
  </nav>

     </div>

     <div class="row-12" style="clear:both"></div>

  <!-- Some text -->
     <div class="row-12 text-row">

     </div>


  <!-- Search bar-->
     <div class="row-12 search">
         <div class="input-group">
           <input id="SearchBar" type="text" class="form-control" placeholder="Find your movie!"></input>
             <div class="input-group-btn">
               <button id="SearchButton" class="btn btn-default" type="submit"><i class="fa fa-search" aria-hidden="true"></i><i> Search </i></button>
            </div>
              </div>
                </div>


  <!-- Place for four movies -->
     <div class="row-12 movies">
        <div class="result-0 result"></div>
        <div class="result-1 result"></div>
        <div class="result-2 result"></div>
        <div class="result-3 result"></div>
        <div style="clear:both"></div>
     </div>

     <div class="row-12 movie-details"></div>

     <div class="row-12 top-10">
         <div class="top-0 result"></div>
         <div class="top-1 result"></div>
         <div class="top-2 result"></div>
         <div class="top-3 result"></div>
         <div class="top-4 result"></div>
         <div class="top-5 result"></div>
         <div class="top-6 result"></div>
         <div class="top-7 result"></div>
         <div class="top-8 result"></div>
         <div class="top-9 result"></div>
         <div style="clear:both"></div>
     </div>

  <!-- Footer -->
     <div class="row-12 footer">

     </div>

     </div>

  <!-- Right side column-->

    <div class="col-4 trapez">

    </div>



 </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>

<script>
  const apiKey = '?api_key=a7f7d0f12e764bab89e2aeb212e2e9c4',
    url = 'http://api.themoviedb.org/3/',
    mode = 'search/movie',
    urlTop10 = 'https://api.themoviedb.org/3/movie/top_rated',
    language = '&language=en-US&page=1';

  $('#SearchButton').click(() => {
    let input = $('#SearchBar').val(),
      movieName = encodeURI(input);
    $.ajax({
      url: url + mode + apiKey + '&query=' + movieName,
      dataType: 'jsonp',
      success: fullMoviesList => showMovies(fullMoviesList.results)
    });

  });

  function showMovies(movies) {
    movies.forEach((movie, i) => {
      console.log(movie);
      if (i < 4) {
        $(`.result-${i}`).append(`
              <div>
                <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" class="movie-poster"/>
                </br></br>
                <b>${movie.title} (${movie.release_date.slice(0,4)})</b>
              </div>
            `);
      }
      $(`.result-${i}`).click(() => {
        $('.trapez').html(`
          <div>
          <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" class="movie-poster"/>
          <div>
          `);

        $('.result').removeClass('select');
        $(`.result-${i}`).addClass('select');

        $('.movie-details').html(`
          <b>Rating: </b>${movie.vote_average}
          </br>
          <b>Original language: </b>${movie.original_language}
          </br>
          <b>Description:</b>
          </br>
          ${movie.overview}
          </br>
        `);
		});
    });
  }

// top 10 movies
  $('#top10').click(() => {
    $.ajax({
      url: urlTop10 + apiKey + language,
      dataType: 'jsonp',
      success: top10List => showTop10(top10List.results)
    });
  });

  function showTop10(movies) {
    // $('.movies').empty();
    // $('.movie-details').empty();
    // $('.trapez').empty();
    movies.forEach((movie, i) => {
      console.log(movie);
      if(i < 10) {
        $(`.top-${i}`).append(`
          <div>
            <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" class="movie-poster"/>
            </br></br>
            <b>${movie.title} (${movie.release_date.slice(0,4)})</b>
            </br>
            <b>Rating: </b>${movie.vote_average}
          </div>
          `);
        }
      });
    }
</script>


</body>
</html>
