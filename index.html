<!DOCTYPE html>
<html lang="en">
  <head>
    <script type="text/javascript" src="movie.js"></script>
    <title>Movie 4 today</title>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link rel="stylesheet" href="movie.css" type="text/css">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css" integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <link rel="stylesheet" href="fontello/css/fontello.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <script src="http://code.jquery.com/jquery-3.2.1.min.js"></script>
  </head>
  <body>
  <!--All content of the page is in the container-->
<div class="container-fluid ">
 <div class="row">
   <div class="col-9">

     <div class="row-3 logo">
        <i class="icon-video"></i>
     </div>

     <div class="row-9 nav">
        <ul>
          <li><a href="#">Home#1</a></li>
          <li><a href="#">Home#2</a></li>
          <li><a href="#">Home#3</a></li>
        </ul>
     </div>

     <div class="row-12" style="clear:both"></div>

  <!-- Some text -->
     <div class="row-12 text-row">


     </div>


  <!-- Search bar-->
     <div class="row-12 search">
       <input id="SearchBar" type="text" style="width: 350px;" placeholder="Find your movie"/>
       <button id="SearchButton"><i>Search</i></button>
     </div>


  <!-- Place for four movies -->
     <div class="row-12 movies">
        <div class="result-0 result"></div>
        <div class="result-1 result"></div>
        <div class="result-2 result"></div>
        <div class="result-3 result"></div>
        <div style="clear:both"></div>
     </div>

     <div class="row-12 movie-details"></div>

  <!-- Footer -->
     <div class="row-12 footer">

     </div>

     </div>

  <!-- Right side column-->

    <div class="col-3 trapez">

    </div>



 </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js" integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh" crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js" integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ" crossorigin="anonymous"></script>

<script>
  const apiKey = '?api_key=a7f7d0f12e764bab89e2aeb212e2e9c4',
    url = 'http://api.themoviedb.org/3/',
    mode = 'search/movie';

  $('button').click(() => {
    let input = $('#SearchBar').val(),
      movieName = encodeURI(input);
    $.ajax({
      url: url + mode + apiKey + '&query=' + movieName,
      dataType: 'jsonp',
      success: fullMoviesList => showMovies(fullMoviesList.results)
    });

  });

  function showMovies(movies) {
    movies.forEach((movie, i) => {
      console.log(movie);
      if (i < 4) {
        $(`.result-${i}`).append(`
              <div>
                <b>${movie.title} (${movie.release_date.slice(0,4)})</b>
                </br>
                <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" class="movie-poster"/>
                </br>
              </div>
            `);
      }
      $(`.result-${i}`).click(() => {
        $('.trapez').html(`
          <div>
          <img src="https://image.tmdb.org/t/p/w500${movie.poster_path}" class="movie-poster"/>
          <div>
          `);

        $('.result').removeClass('select');
        $(`.result-${i}`).addClass('select');

        $('.movie-details').html(`
          <b>Rating: </b>${movie.vote_average}
          </br>
          <b>Original language: </b>${movie.original_language}
          </br>
          <b>Description:</b>
          </br>
          ${movie.overview}
          </br>
        `);
		});
    });
  }
</script>


</body>
</html>
